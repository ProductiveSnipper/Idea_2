setwd("~/")
#load relevant packages
install.packages("labelled")
library(tidyverse)
library(labelled)
#load file
data <- read.csv("synth_random10.csv", header = T)
setwd("C:/Users/amo2349/OneDrive - University of North Carolina at Chapel Hill/CAnD3/IDEA_2_Data/Idea_2")
data <- read.csv("synth_random10.csv", header = T)
#### Action Plan -----
#1) Create an ID for each record
#2) Recode and label the following predictors
#       Cancer mortality (0 = No death by cancer; 1 = Death by cancer)
#       Income (0 = Not low income; 1= Low income)
#       Gender (0 = Male; 1 = Female)
#       Minority (0 = other, 1 = Minority, 2 = Indiginity)
#3) Assess for missing values
#4) Drop all other variables
#
## Create an ID for each record ----
data <- data|>
mutate(ID = row_number()) |>
select(ID,everything())
## Recode and Label Predictors ----
## Cancer Mortality
#create a new variable with cancer (binary)
data <- data |>
mutate(cancer = case_when(
COD2_synth <= 2 ~ 0,
COD2_synth == 3 ~ 1,
COD2_synth == 4 ~ 1,
COD2_synth >= 5 & COD2_synth <= 13 ~ 0,
COD2_synth == 14 ~ 2
))
data <- data |> select(-cancer)
table(data$cancer)
# print
# 0         1
# 432604   2061
#label the variables
cancer <- labelled(data$cancer, c("Death by Other" = 0,"Death by Cancer" = 1, "Alive" = 2))
# cancer <- labelled(data$cancer, c("Death by Other" = 0,"Death by Cancer" = 1, "Alive" = 2))
# cancer <- labelled(data$cancer, c("Death by Other" = 0,"Death by Cancer" = 1, "Alive" = 2))
# cancer <- labelled(data$cancer, c("Death by Other" = 0,"Death by Cancer" = 1, "Alive" = 2))
data <-data |>
mutate(cancer_lab = case_when(
cancer == 0 ~ "Death by Other",
cancer == 1 ~ "Death by Cancer",
cancer == 2 ~ "Alive"
))
table(data$cancer)
data <-data |>
mutate(cancer_lab = case_when(
cancer == 0 ~ "Death by Other",
cancer == 1 ~ "Death by Cancer",
cancer == 2 ~ "Alive"
))
data <- data |>
mutate(cancer = case_when(
COD2_synth <= 2 ~ 0,
COD2_synth == 3 ~ 1,
COD2_synth == 4 ~ 1,
COD2_synth >= 5 & COD2_synth <= 13 ~ 0,
COD2_synth == 14 ~ 2
))
data <-data |>
mutate(cancer_lab = case_when(
cancer == 0 ~ "Death by Other",
cancer == 1 ~ "Death by Cancer",
cancer == 2 ~ "Alive"
))
table(data$cancer_lab)
#create a new variable with income
table(data$LOINCA_synth)
data <- data |>
mutate(income = case_when(
LOINCA_synth == 1 ~ "Not Low Income",
LOINCA_synth == 2 ~ "Low Income",
TRUE ~ NA))
table(data$income)
## Gender
table(data$SEX_synth)
data <- data |>
mutate(sex = case_when(
SEX_synth == 1 ~ "Female",
SEX_synth == 2 ~ "Male",
TRUE ~ NA))
table(data$sex)
## Minority
data <- data |>
mutate(minority_status = case_when(
DVISMIN_synth >= 1 & DVISMIN_synth <= 12 ~ "Visible Minority",
DVISMIN_synth == 13 ~ "Indigenous",
DVISMIN_synth == 14 ~ "Non-Minority",
TRUE ~ NA))
table(data$minority_status)
data_clean <- data |>
select(ID, cancer_lab, income, sex, minority_status)
##### VERIFY THE DATA -----
ggplot(data_clean, aes(income, ID))+
geom_bar(stat="identity", fill = "seagreen")
View(data_clean)
View(data_clean)
View(data_clean)
table(data$minority_status)
table(data$minority_status, data$cancer_lab)
table(data$minority_status, data$cancer_lab)
# Generic ggplot for two categorical variables (X and Fill)
ggplot(data, aes(x = minority_status, fill = cancer_lab)) +
# "dodge" puts bars side-by-side for raw counts
geom_bar(position = "dodge") +
# Labels and visual cleanup
labs(
title = "Raw Counts: Variable 1 by Variable 2",
x = "Variable 1 Name",
y = "Total Count",
fill = "Variable 2 Legend"
) +
theme_minimal()
table(data$income)
table(data$SEX_synth)
table(data$sex)
install.packages("labelled")
setwd("C:/Users/amo2349/OneDrive - University of North Carolina at Chapel Hill/CAnD3/IDEA_2_Data/Idea_2")
data <- read.csv("synth.csv", header = T)
## Create an ID for each record ----
data <- data|>
mutate(ID = row_number()) |>
select(ID,everything())
## Recode and Label Predictors ----
## Cancer Mortality
#create a new variable with cancer (binary)
data <- data |>
mutate(cancer = case_when(
COD2_synth <= 2 ~ 0,
COD2_synth == 3 ~ 1,
COD2_synth == 4 ~ 1,
COD2_synth >= 5 & COD2_synth <= 13 ~ 0,
COD2_synth == 14 ~ 2
))
# data <- data |> select(-cancer)
table(data$cancer)
#label the variables
# cancer <- labelled(data$cancer, c("Death by Other" = 0,"Death by Cancer" = 1, "Alive" = 2))
data <-data |>
mutate(cancer_lab = case_when(
cancer == 0 ~ "Death by Other",
cancer == 1 ~ "Death by Cancer",
cancer == 2 ~ "Alive"
))
table(data$cancer_lab)
## Income
#create a new variable with income
table(data$LOINCA_synth)
data <- data |>
mutate(income = case_when(
LOINCA_synth == 1 ~ "Not Low Income",
LOINCA_synth == 2 ~ "Low Income",
TRUE ~ NA))
table(data$income)
table(data$SEX_synth)
data <- data |>
mutate(sex = case_when(
SEX_synth == 1 ~ "Female",
SEX_synth == 2 ~ "Male",
TRUE ~ NA))
table(data$sex)
## Minority
data <- data |>
mutate(minority_status = case_when(
DVISMIN_synth >= 1 & DVISMIN_synth <= 12 ~ "Visible Minority",
DVISMIN_synth == 13 ~ "Indigenous",
DVISMIN_synth == 14 ~ "Non-Minority",
TRUE ~ NA))
table(data$minority_status)
data_clean <- data |>
select(ID, cancer_lab, income, sex, minority_status)
##### VERIFY THE DATA -----
table(data$minority_status, data$cancer_lab)
ggplot(data_clean, aes(income, ID))+
geom_bar(stat="identity", fill = "seagreen")
# Generic ggplot for two categorical variables (X and Fill)
ggplot(data, aes(x = minority_status, fill = cancer_lab)) +
# "dodge" puts bars side-by-side for raw counts
geom_bar(position = "dodge") +
# Labels and visual cleanup
labs(
title = "Raw Counts: Death Type by VMS ",
x = "Vissible Minority Status",
y = "Total Count",
fill = "Type of Death Legend"
) +
theme_minimal()
# Generic ggplot for two categorical variables (X and Fill)
ggplot(data, aes(x = minority_status, fill = cancer_lab)) +
# "dodge" puts bars side-by-side for raw counts
geom_bar(position = "dodge") +
# Labels and visual cleanup
labs(
title = "Raw Counts: Death Type by VMS ",
x = "Visible Minority Status",
y = "Total Count",
fill = "Type of Death Legend"
) +
theme_minimal()
#full dataset
data <- read.csv("synth.csv", header = T)
## Create an ID for each record ----
data <- data|>
mutate(ID = row_number()) |>
select(ID,everything())
#create a new variable with cancer (binary)
data <- data |>
mutate(cancer = case_when(
COD2_synth <= 2 ~ 0,
COD2_synth == 3 ~ 1,
COD2_synth == 4 ~ 1,
COD2_synth >= 5 & COD2_synth <= 13 ~ 0,
COD2_synth == 14 ~ 2
))
table(data$cancer)
data <-data |>
mutate(cancer_lab = case_when(
cancer == 0 ~ "Death by Other",
cancer == 1 ~ "Death by Cancer",
cancer == 2 ~ NA
))
table(data$cancer_lab)
table(data$LOINCA_synth)
data <- data |>
mutate(income = case_when(
LOINCA_synth == 1 ~ "Not Low Income",
LOINCA_synth == 2 ~ "Low Income",
TRUE ~ NA))
table(data$income)
table(data$SEX_synth)
data <- data |>
mutate(sex = case_when(
SEX_synth == 1 ~ "Female",
SEX_synth == 2 ~ "Male",
TRUE ~ NA))
table(data$sex)
data <- data |>
mutate(minority_status = case_when(
DVISMIN_synth >= 1 & DVISMIN_synth <= 12 ~ "Visible Minority",
DVISMIN_synth == 13 ~ "Indigenous",
DVISMIN_synth == 14 ~ "Non-Minority",
TRUE ~ NA))
table(data$minority_status)
data_clean <- data |>
select(ID, cancer_lab, income, sex, minority_status)
table(data$minority_status, data$cancer_lab)
install.packages("table1")
library(table1)
gc()
# Generic ggplot for two categorical variables (X and Fill)
ggplot(data, aes(x = minority_status, fill = cancer_lab)) +
# "dodge" puts bars side-by-side for raw counts
geom_bar(position = "dodge") +
# Labels and visual cleanup
labs(
title = "Raw Counts: Death Type by VMS ",
x = "Visible Minority Status",
y = "Total Count",
fill = "Type of Death Legend"
) +
theme_minimal()
View(data_clean)
View(data_clean)
table1(minority_status, cancer_lab, sex_income, data = data_clean
)
table1(data_clean$minority_status, data_clean$cancer_lab, data_clean$sex_income, data = data_clean)
table1(data_clean$minority_status, data_clean$cancer_lab, data_clean$sex_income)
?table1
table1(~ minority_status + cancer_lab + sex_income, data=data_clean)
table1(~ minority_status + cancer_lab + sex + income, data=data_clean)
table1(~ minority_status + sex + income | cancer_lab, data=data_clean)
mortality <- na.omit(data_clean)
table1(~ minority_status + sex + income | cancer_lab, data=mortality)
table(data$minority_status, data$cancer_lab)
table(mortality$minority_status, mortality$cancer_lab)
summary(data_clean)
summarise(data_clean)
detail(data_clean)
table1(~ minority_status + sex + income | cancer_lab, data=data_clean)
table1(~ minority_status + sex + income | cancer_lab, data=mortality)
